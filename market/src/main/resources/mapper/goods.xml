<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.dao.GoodsDao">
	<!-- 상품 판매 글 등록 -->
	<insert id="goods_reg" parameterType="goods">
		insert into goods values
		(null, #{member_no}, #{category_no}, #{goods_name},#{goods_content},
		#{goods_price},null, 0, sysdate(), '1', #{goods_image})
	</insert>

	<!-- 최저가 비교 상품 갯수 -->
	<select id="compare_list_count" parameterType="String"
		resultType="int">
	<![CDATA[
    select count(*) from goods where goods_name LIKE CONCAT('%', #{goods_name}, '%') and goods_state='3' and goods_regdate >= DATE_SUB(sysdate(), INTERVAL 30 DAY) AND goods_regdate < sysdate();
	]]>

	</select>
	
	<!-- 최저가 비교 상품 리스트 -->
	<select id="get_compare_list" parameterType="goods" resultType="goods">
		<![CDATA[
		select * from goods where goods_name LIKE CONCAT('%', #{goods_name}, '%')  and goods_state='3' and goods_regdate >= DATE_SUB(sysdate(), INTERVAL 30 DAY) AND goods_regdate < sysdate() order by goods_regdate desc
		limit #{start_list},12;
	]]>
	</select>

	<!-- 글 갯수 -->
	<select id="goods_listcount" parameterType="int" resultType="int">
		SELECT COUNT(*) FROM goods
	</select>

	<!-- 글 목록 -->
	<select id="goods_list" parameterType="int" resultType="goods">
		SELECT * FROM goods ORDER BY goods_regdate DESC LIMIT #{start}, 12
	</select>

	<!-- 인기글 목록 -->
	<select id="best_list" resultType="goods">
		SELECT * FROM goods ORDER BY goods_readcount DESC LIMIT 0, 12
	</select>
</mapper>